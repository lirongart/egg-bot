מוכן - נכתוב מחדש עכשיו את הקוד המלא פה (הקוד המלא חורג מתשובה אחת)